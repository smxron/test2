{% block content %}
    <div class="container">
        <h2>
            {% if model.isNewRecord %}
                Создать сделку
            {% else %}
                Редактировать сделку: {{ model.name }}
            {% endif %}
        </h2>

        <form method="post" action="" class="form-horizontal">

            <div class="form-group {{ errors.name ? 'has-error' : '' }}">
                <label class="control-label col-md-2" for="deal-name">
                    Наименование *
                </label>
                <div class="col-md-10">
                    <input
                            type="text"
                            id="deal-name"
                            name="Deal[name]"
                            value="{{ model.name }}"
                            class="form-control"
                            required
                    >
                    {% if errors.name %}
                        <span class="help-block text-danger">
                        {{ errors.name[0] }}
                    </span>
                    {% endif %}
                </div>
            </div>

            <div class="form-group {{ errors.amount ? 'has-error' : '' }}">
                <label class="control-label col-md-2" for="deal-amount">
                    Сумма
                </label>
                <div class="col-md-10">
                    <input
                            type="number"
                            id="deal-amount"
                            name="Deal[amount]"
                            value="{{ model.amount }}"
                            step="0.01"
                            min="0"
                            class="form-control"
                    >
                    {% if errors.amount %}
                        <span class="help-block text-danger">
                        {{ errors.amount[0] }}
                    </span>
                    {% endif %}
                </div>
            </div>

            <div class="form-group {{ errors.contactIds ? 'has-error' : '' }}">
                <label class="control-label col-md-2">
                    Контакты
                </label>
                <div class="col-md-10">
                    <div class="checkbox-list">
                        {% for contact in contacts %}
                            <label class="checkbox-inline">
                                <input
                                        type="checkbox"
                                        name="Deal[contactIds][]"
                                        value="{{ contact.id }}"
                                        {{ contact.id in model.contactIds ? 'checked' : '' }}
                                >
                                {{ contact.firstName }} {{ contact.lastName }}
                            </label>
                        {% else %}
                            <p class="text-muted">Нет доступных контактов</p>
                        {% endfor %}
                    </div>
                    {% if errors.contactIds %}
                        <span class="help-block text-danger">
                        {{ errors.contactIds[0] }}
                    </span>
                    {% endif %}
                </div>
            </div>

            <div class="form-group">
                <div class="col-md-offset-2 col-md-10">
                    <button type="submit" class="btn btn-primary">
                        {% if model.isNewRecord %}
                            Создать
                        {% else %}
                            Сохранить
                        {% endif %}
                    </button>
                    <a href="{{ path('site/index', {menu: 'deals'}) }}" class="btn btn-default">
                        Отмена
                    </a>
                </div>
            </div>
        </form>
    </div>

    <style>
        .checkbox-list {
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid #ddd;
            padding: 10px;
            border-radius: 4px;
            background: #f9f9f9;
        }
        .checkbox-inline {
            display: block;
            margin-bottom: 8px;
            padding: 5px;
            border-radius: 3px;
            transition: background-color 0.2s;
        }
        .checkbox-inline:hover {
            background-color: #f0f0f0;
        }
        .has-error .checkbox-list {
            border-color: #a94442;
        }
    </style>
{% endblock %}